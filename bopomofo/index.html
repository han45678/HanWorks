<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8" />
    <title>台灣注音拼音表</title>
    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <!-- howler.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
    <style>
        .container {
            padding: 20px;
            font-family: sans-serif;
        }

        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
        }

        button {
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        button.active {
            background-color: #4caf50;
            color: white;
        }

        .result {
            margin-top: 20px;
            font-size: 1.5rem;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div id="app" class="container">
        <h1>台灣注音拼音表</h1>

        <!-- 聲母 -->
        <div class="onsets">
            <h2>聲母 (Onset)</h2>
            <div class="buttons">
                <button v-for="onset in onsets" :key="onset.name" @click="selectOnset(onset)"
                    :class="{ active: onset.name === selectedOnset?.name }">
                    {{ onset.name }}
                </button>
            </div>
        </div>

        <!-- 介音 -->
        <div v-if="selectedOnset" class="medials">
            <h2>介音 (Medial) for {{ selectedOnset.name }}</h2>
            <div class="buttons">
                <button v-for="medial in selectedOnset['medial-link']" :key="medial.name" @click="selectMedial(medial)"
                    :class="{ active: medial.name === selectedMedial?.name }">
                    {{ medial.name }}
                </button>
            </div>
        </div>

        <!-- 韻母 -->
        <div v-if="selectedMedial" class="finals">
            <h2>韻母 (Finals) for {{ selectedOnset.name }} + {{ selectedMedial.name }}</h2>
            <div class="buttons">
                <button v-for="final in selectedMedial['finals-link']" :key="final.name" @click="selectFinal(final)">
                    {{ final.name }}
                </button>
            </div>
        </div>

        <!-- 顯示組合拼音 -->
        <div v-if="selectedFinal" class="result">
            <h2>組合拼音:</h2>
            <p>{{ selectedOnset.name }}{{ selectedMedial.name }}{{ selectedFinal.name }}</p>
        </div>
    </div>

    <script>
        const { createApp, ref } = Vue

        createApp({
            setup() {
                // ✅ 簡化版 JSON，請依需求擴充
                const onsets = ref([
                    {
                        "name": "ㄅ",
                        "type": "onset",
                        "onset-link": null,
                        "medial-link": [
                            {
                                "name": "ㄧ",
                                "finals-link": [
                                    { "name": "ㄚ", "finals-link": null },
                                    { "name": "ㄛ", "finals-link": null },
                                    { "name": "ㄞ", "finals-link": null }
                                ]
                            },
                            {
                                "name": "ㄨ",
                                "finals-link": [
                                    { "name": "ㄚ", "finals-link": null },
                                    { "name": "ㄛ", "finals-link": null },
                                    { "name": "ㄨㄛ", "finals-link": null }
                                ]
                            }
                        ],
                        "finals-link": []
                    },
                    {
                        "name": "ㄆ",
                        "type": "onset",
                        "onset-link": null,
                        "medial-link": [
                            {
                                "name": "ㄧ",
                                "finals-link": [
                                    { "name": "ㄚ", "finals-link": null },
                                    { "name": "ㄛ", "finals-link": null }
                                ]
                            },
                            {
                                "name": "ㄨ",
                                "finals-link": [
                                    { "name": "ㄚ", "finals-link": null },
                                    { "name": "ㄨㄛ", "finals-link": null }
                                ]
                            }
                        ],
                        "finals-link": []
                    }
                ])

                const selectedOnset = ref(null)
                const selectedMedial = ref(null)
                const selectedFinal = ref(null)

                // ✅ 播放聲音
                function playSound(name) {
                    const sound = new Howl({
                        src: [`./audio/${name}.mp3`],
                        volume: 1.0
                    })
                    sound.play()
                }

                function selectOnset(onset) {
                    selectedOnset.value = onset
                    selectedMedial.value = null
                    selectedFinal.value = null
                    playSound(onset.name)
                }

                function selectMedial(medial) {
                    selectedMedial.value = medial
                    selectedFinal.value = null
                    playSound(medial.name)
                }

                function selectFinal(final) {
                    selectedFinal.value = final
                    playSound(final.name)
                }

                return {
                    onsets,
                    selectedOnset,
                    selectedMedial,
                    selectedFinal,
                    selectOnset,
                    selectMedial,
                    selectFinal
                }
            }
        }).mount('#app')
    </script>
</body>

</html>